<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" media="screen" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

    <style>
        .btnCreate{
            border: none;
            border-radius: 1.5rem;
            width: 80px;
            height: 40px;
            cursor: pointer;
            background: #0062cc;
            color: #fff;
        }
        .btnDelete{
            border: none;
            border-radius: 1.5rem;
            width: 80px;
            height: 40px;
            cursor: pointer;
            background:red;
            color: #fff;
        }
        .header{
            background-color: darkcyan;
            display: flex; 
            flex-direction: row; 
            justify-content: space-between;
            color:#ffffff;
            align-items: center;
        }

        .nav-left{
            display: flex;
            flex-direction: row;
            column-gap: 12px;
        }

        .tbody{
            justify-content: center;
            align-items: center;
        }
    </style>
</head>

<body>
    
<nav class="navbar navbar-dark bg-dark">
  <a class="navbar-brand">Hi, {{name}}</a>
  
    <div class="nav-left">
        {% if user.is_authenticated %}
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
            Create Invoice
        </button>
        <a href="/logout">
        <button type="button" class="btn btn-primary">
            Logout
        </button>
        </a>
        {% endif %}
    </div>
</nav>
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            <form action="/account/" method="post" style="display: flex; flex-direction: column; row-gap: 12px;">
                {% csrf_token %}
                <h4 style="color:red">{{message}}</h4>
                <select style="width: 80%; height: 30px;" name="customer" id="customer" placeholder="Customer" required>
                    <option value="None">Select</option>
                    {% for customer in customers %}
                    <option value={{customer.0}}>{{customer.1}}</option>
                    {% endfor %}
                </select>
                <input style="width: 80%; height: 30px;" type="applicable_taxes" name="applicable_taxes" id="applicable_taxes" placeholder="Applicable Taxes" required />
                <input style="width: 80%; height: 30px;" type="gst_number" name="gst_number" id="gst_number" placeholder="GST Number" />
                <button type="submit" class="btnCreate">Create</button>        
            </form>
        </div>
    </div>
    </div>
  </div>
    <div class="container mt-5">
    <div class="table-responsive">
        <table class="table table-striped table-dark text-white table-hover">
            <thead>
                <tr>
                    <th class="text-center">
                        <input type="checkbox" name="pageCheck" value="yes" onclick="checkAll(this)">
                    </th>
                    <th>Invoice</th>
                    <th>Name</th>
                    <th>Created At</th>
                </tr>
            </thead>
            <tbody>
                {% for invoice in invoices %}
                
                    <tr class="tbody">
                        <td class="text-center"><input type="checkbox" class="invoice_id" value={{invoice.id}}></td>
                        <td>
                            <h6>{{invoice.invoice_number}}</h6>
                        </td>
                        <td>{{invoice.customer.name}}</td>
                        <td class="font-weight-bold">{{invoice.created_at}}</td>
                        <td>
                            <a href="/account/?invoice_number={{invoice.invoice_number}}">
                                <button class="btnCreate">View</button>
                            </a>
                        </td>
                        <td>
                            <form action="/account/" method="get">
                                {% csrf_token %}
                                <input hidden=true name="type" value="delete">
                                <button class="btnDelete" type="submit" value={{invoice.invoice_number}} name="invoice_number">Delete</button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    function checkAll(bx) {
        var cbs = document.getElementsByTagName('input');
        for(var i=0; i < cbs.length; i++) {
            if(cbs[i].type == 'checkbox') {
                cbs[i].checked = bx.checked;
                console.log(cbs[i].value);
            }
        }
    }
    function deleteInvoice(){
        var selected = document.getElementsByClassName('invoice_id');
        for(i in selected){
            if(i.checked) console.log(i);
        }
    }

</script>
</body>
</html>